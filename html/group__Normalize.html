<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Xmipp: Normalization of images and volumes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xmipp_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Xmipp
   &#160;<span id="projectnumber">v20.07</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Normalization of images and volumes</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classProgNormalize.html">ProgNormalize</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Image normalization procedures</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrp98fbd8711d2afe6a6485b6e742ee181a"></a>This functions implement the normalization of a single image. They should be called with all images in the corresponding <a class="el" href="classSelFile.html">SelFile</a>. In the following documentation m(x) is the mean of x, v(x) is the variance, bg(x) is its background.</p>
<p>The original image is X and is supposed to be related to each single projection by I=a*(X+n)+b where a and b are different for every projection.</p>
<p>Noise is assumed to follow a gaussian distribution N(0,sqrt(v(n)))</p>
<p>In general the background mask is used only to compute statistics, while the mask is the one which is really applied to the image. Supply NULL if you don't want any mask to be applied</p>
<p>When b is used it is measured as the mean in the background, while a*sqrt(v(n)) is the standard deviation in the same area. </p>
</td></tr>
<tr class="memitem:ga3816a01b39c37c2b6fbc27841426d375"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Normalize.html#ga3816a01b39c37c2b6fbc27841426d375">normalize_OldXmipp</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I)</td></tr>
<tr class="separator:ga3816a01b39c37c2b6fbc27841426d375"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga607840d4422fc8d37cab493300620b58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Normalize.html#ga607840d4422fc8d37cab493300620b58">normalize_Near_OldXmipp</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;bg_mask)</td></tr>
<tr class="separator:ga607840d4422fc8d37cab493300620b58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga329a2c9e0148ba20d02b9787888ee422"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Normalize.html#ga329a2c9e0148ba20d02b9787888ee422">normalize_OldXmipp_decomposition</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;bg_mask, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *mask=NULL)</td></tr>
<tr class="separator:ga329a2c9e0148ba20d02b9787888ee422"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb921d78efb86e7fc4ea5afe5d48be37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Normalize.html#gafb921d78efb86e7fc4ea5afe5d48be37">normalize_tomography</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, double tilt, double &amp;mui, double &amp;sigmai, bool tiltMask, bool tomography0=false, double mu0=0, double sigma0=1)</td></tr>
<tr class="separator:gafb921d78efb86e7fc4ea5afe5d48be37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8758f482f5e7d5939fb7f22000b3437f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Normalize.html#ga8758f482f5e7d5939fb7f22000b3437f">normalize_Michael</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;bg_mask)</td></tr>
<tr class="separator:ga8758f482f5e7d5939fb7f22000b3437f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada2ad8d95626323a3da6c26c22fb1762"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Normalize.html#gada2ad8d95626323a3da6c26c22fb1762">normalize_NewXmipp</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;bg_mask)</td></tr>
<tr class="separator:gada2ad8d95626323a3da6c26c22fb1762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f05e421067893cdc87c7c224962f991"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Normalize.html#ga7f05e421067893cdc87c7c224962f991">normalize_NewXmipp2</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;bg_mask)</td></tr>
<tr class="separator:ga7f05e421067893cdc87c7c224962f991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa81fefa03525c5f4981dcadc2392fe07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Normalize.html#gaa81fefa03525c5f4981dcadc2392fe07">normalize_Robust</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;bg_mask, bool clip)</td></tr>
<tr class="separator:gaa81fefa03525c5f4981dcadc2392fe07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac947cd7ad53ceac5d45f230fb7cd2147"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Normalize.html#gac947cd7ad53ceac5d45f230fb7cd2147">normalize_ramp</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *bg_mask=NULL)</td></tr>
<tr class="separator:gac947cd7ad53ceac5d45f230fb7cd2147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa5c1b883cdb3ae7017d1e1d7075b33c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Normalize.html#gaaa5c1b883cdb3ae7017d1e1d7075b33c">normalize_remove_neighbours</a> (<a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;I, const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;bg_mask, const double &amp;<a class="el" href="lib__vwk_8h.html#a624a8b0f9f8900df6f540fa654e179b3">threshold</a>)</td></tr>
<tr class="separator:gaaa5c1b883cdb3ae7017d1e1d7075b33c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga8758f482f5e7d5939fb7f22000b3437f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_Michael </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>bg_mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Michael's normalization.</p>
<p>Formula: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;I&#39;=(I-b)/b</div></div><!-- fragment --><p> Properties: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;m(I&#39;)=0                             m(bg(I&#39;))=-a*m(x)/b</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;v(I&#39;)=a^2*(v(X)+v(n))/b^2           v(bg(I&#39;))=a^2*v(n)/b^2</div></div><!-- fragment --><p> Comments: it's not bad but positivity constraints cannot be imposed and the statistical properties are not so good. </p>

</div>
</div>
<a class="anchor" id="ga607840d4422fc8d37cab493300620b58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_Near_OldXmipp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>bg_mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Near_OldXmipp normalization.</p>
<p>Formula: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;I&#39;=(I-m(I))/sqrt(v(bg))</div></div><!-- fragment --><p> Properties: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;m(I&#39;)=0                             m(bg(I&#39;))=-m(x)/sqrt(v(n))</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;v(I&#39;)=(v(X)+v(n))/v(n)              v(bg(I&#39;))=1</div></div><!-- fragment --><p> Comments: it's not bad but positivity constraints cannot be imposed </p>

</div>
</div>
<a class="anchor" id="gada2ad8d95626323a3da6c26c22fb1762"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_NewXmipp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>bg_mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>NewXmipp's normalization.</p>
<p>Formula: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;I&#39;=(I-b)/a*sqrt(v(n))</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;// I&#39;&#39;=(I&#39;&gt;0)? I&#39;:0</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;// I&#39;&#39;&#39;=I&#39;&#39;-a*sqrt(v(n)/2*PI)</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;I&#39;&#39;&#39;&#39;=I&#39;&#39;&#39;*mask</div></div><!-- fragment --><p> Properties: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;m(I&#39;)=m(X)/sqrt(v(n))               m(bg(I&#39;))=0</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;v(I&#39;)=(v(X)+v(n))/v(n)              v(bg(I&#39;))=1</div></div><!-- fragment --><p> Comments: In general, we cannot assure that mass projects into positive numbers, so the "denoising" capability directly on the images is disabled. However, a positivity constraint can be applied on the 3D volume. </p>

</div>
</div>
<a class="anchor" id="ga7f05e421067893cdc87c7c224962f991"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_NewXmipp2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>bg_mask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>NewXmipp 2's normalization.</p>
<p>Formula: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;I&#39;=(I-m(bg))/(m(I)-m(bg))</div></div><!-- fragment --><p> Properties: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;m(I&#39;)=m(X)/sqrt(v(n))               m(bg(I&#39;))=0</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;v(I&#39;)=(v(X)+v(n))/v(n)              v(bg(I&#39;))=1</div></div><!-- fragment --><p> Comments: In general, we cannot assure that mass projects into positive numbers, so the "denoising" capability directly on the images is disabled. However, a positivity constraint can be applied on the 3D volume. </p>

</div>
</div>
<a class="anchor" id="ga3816a01b39c37c2b6fbc27841426d375"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_OldXmipp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>OldXmipp normalization.</p>
<p>Formula: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;I&#39;=(I-m(I))/sqrt(v(I))</div></div><!-- fragment --><p> Properties: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;m(I&#39;)=0                             m(bg(I&#39;))=-m(x)/sqrt((v(X)+v(n)))</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;v(I&#39;)=1                             v(bg(I&#39;))=v(n)/(v(X)+v(n))</div></div><!-- fragment --><p> Comments: it's not bad but positivity constraints cannot be imposed </p>

</div>
</div>
<a class="anchor" id="ga329a2c9e0148ba20d02b9787888ee422"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_OldXmipp_decomposition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>bg_mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>OldXmipp decomposition.</p>
<p>Formula: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;I&#39;=(I-b)/a*sqrt(v(n))</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;I&#39;&#39;=I&#39;*mask</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;I&#39;&#39;&#39;=(I&#39;&#39;-m(I&#39;&#39;))/sqrt(v(I&#39;&#39;))</div></div><!-- fragment --><p> Properties: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;m(I&#39;)=m(X)/sqrt(v(n))               m(bg(I&#39;))=0</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;v(I&#39;)=(v(X)+v(n))/v(n)              v(bg(I&#39;))=1</div></div><!-- fragment --><p> Comments: it's not bad but positivity constraints cannot be imposed. If no mask is applied, then this formula is a beautiful decomposition of the OldXmipp method in two steps. </p>

</div>
</div>
<a class="anchor" id="gac947cd7ad53ceac5d45f230fb7cd2147"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_ramp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>bg_mask</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removal of inclined background densities (ramps).</p>
<p>fitting of a least squares plane through the pixels in the bg_mask, then subtraction of the plane, and division by the standard deviation of the pixels in the bg_mask </p>

</div>
</div>
<a class="anchor" id="gaaa5c1b883cdb3ae7017d1e1d7075b33c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_remove_neighbours </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>bg_mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removal of neighbouring particles.</p>
<p>.... </p>

</div>
</div>
<a class="anchor" id="gaa81fefa03525c5f4981dcadc2392fe07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_Robust </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>bg_mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="gafb921d78efb86e7fc4ea5afe5d48be37"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_tomography </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMultidimArray.html">MultidimArray</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>I</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>mui</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>sigmai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>tiltMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>tomography0</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mu0</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma0</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tomography normalization.</p>
<p>This is similar to the OldXmipp normalization, but the mean and standard deviation of the images are computed only within a region determined by the tilt angle. Formula for tomography: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;I&#39;=(I-m(I))/(sqrt(v(I))*cos^2(tilt))</div></div><!-- fragment --><p>Formula for tomography0: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;I&#39;=(I/cos(tilt)-m0)/(sqrt(v(I))*cos(tilt))</div></div><!-- fragment --><p>The estimated mean of the image and the local variance are returned in sigmai and mui. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
